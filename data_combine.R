X24$fcst_time = substr(X24$fcst_time,1,10)
X24$fcst_time = as.POSIXct(X24$fcst_time)
X24$precsecond <- X24$stationID+X24$fcst_time
X24$actsecond <-X24$stationID__1+X24$Date_time

channel <- dbConnect(MySQL(), host = "123.56.193.234",username = "tq007",
                     password ="tianqi888_", dbname = 'weather')


channel <- dbConnect(MySQL(), host = "47.93.178.84",username = "tq007",
                     password ="tianqi888_", dbname = 'ap_data')


data = dbGetQuery(channel, "select stationID, fcst_time, prec20_20 from fcst_fine12h_history_12to24
                  where stationID in (54812, 54814, 54815, 54816, 54818, 54819, 54821, 54822, 54823, 54824, 54825, 
                  54827, 54828, 54829, 57960, 58138, 58143, 59211, 57942, 57947, 57955, 57956, 58146, 58147, 58148, 
                  59027, 59209, 59213, 58549, 58550, 58557, 58558, 58633, 58647, 58737, 58745, 58747, 58748, 58917, 
                  58918, 58928, 58929, 59417, 59425, 59087, 59088, 59137, 59237, 59268, 59269, 59271, 59285, 59293,
                  59303, 59312, 59313 ) and vti = 24")

data = dbGetQuery(channel, "select flight_no, dept_airport, arr_airport, plan_dept_time, real_dept_time, dept_delay_time
                             plan_arr_time, real_arr_time, flight_date, delay_time from aiportmatchdata where 
                             flight_no = 5116")



data = dbGetQuery(channel, "select stationID, fcst_time, prec20_20 from fcst_fine12h_history_12to24
                  where stationID in (54812, 54814, 54815, 54816, 54818, 54819, 54821, 54822, 54823, 54824, 54825, 
                  54827, 54828, 54829, 57960, 58138, 58143, 59211, 57942, 57947, 57955, 57956, 58146, 58147, 58148, 
                  59027, 59209, 59213, 58549, 58550, 58557, 58558, 58633, 58647, 58737, 58745, 58747, 58748, 58917, 
                  58918, 58928, 58929, 59417, 59425, 59087, 59088, 59137, 59237, 59268, 59269, 59271, 59285, 59293,
                  59303, 59312, 59313 ) and vti = 24")
data = dbGetQuery(channel, "select STATION_ID, DATA_TIME, PREC24 from cmis2018
                  where STATION_ID in (54812, 54814, 54815, 54816, 54818, 54819, 54821, 54822, 54823, 54824, 54825, 
                  54827, 54828, 54829, 57960, 58138, 58143, 59211, 57942, 57947, 57955, 57956, 58146, 58147, 58148, 
                  59027, 59209, 59213, 58549, 58550, 58557, 58558, 58633, 58647, 58737, 58745, 58747, 58748, 58917, 
                  58918, 58928, 58929, 59417, 59425, 59087, 59088, 59137, 59237, 59268, 59269, 59271, 59285, 59293,
                  59303, 59312, 59313 )")

#根据两列数据匹配表格
model.data <- merge(data, data_act, by = c('stationID','Date_time'), all.x = TRUE)


data = data[,1:2]









data = dbGetQuery(channel, "select stationID, fcst_time, prec20_20 from fcst_fine12h_history_12to24
                  where stationID in (54709,54714,54715,54716,54718,54722,54723,54726,54728,54732,54776,54802,54803,54805,
                  59001,59004,54712,54724,54725,54727,54729,54730,54731,54734,54736,54737,54738,54744,
                  54749,54751,54752,54753,54755,54759,54764,54765,54766,54806,54807,54808,54810,54811,
                  54812,54814,54815,54816,54818,54819,54821,54822,54823,54824,54825,54827,54828,54829,
                  54830,54831,54832,54833,54834,54835,54836,54837,54841,54842,54843,54844,54846,54848,
                  54849,54851,54852,54853,54855,54857,54863,54871,54904,54905,54906,54908,54910,54911,
                  54912,54913,54922,54943,59012,54774,54777,54778,54861,54907,54909,54914,54915,54916,
                  54917,54918,54919,54920,54921,54923,54925,54927,54929,54932,54935,54936,54938,54939,
                  54940,54945,57927,58002,58003,58011,58012,58013,58020,58021,58022,58024,58026,58027,
                  58030,58032,58035,58036,58038,58044,58130,58135,59022,57859,57941,58025,58034,58040,
                  58045,58047,58048,58049,58131,58132,58139,58140,58141,58145,59015,59017,59021,59025,
                  57960,58138,58143,59211,57942,57947,57955,57956,58146,58147,58148,59027,59209,59213,
                  57948,57957,58150,58154,58235,58237,58238,58241,58242,58243,58244,58245,58339,58340,
                  58344,58820,58822,59023,59031,59215,57964,58246,58247,58249,58341,58342,58343,58345,
                  58346,58354,58443,58450,58724,58818,58819,58911,58912,58923,58935,59224,57954,58158,
                  58250,58251,58254,58255,58257,58351,58353,58359,58446,58448,58454,58543,58725,58731,
                  58821,58823,58824,58826,58828,58837,58921,58927,58932,59033,59218,58259,58264,58268,
                  58269,58349,58352,58356,58360,58365,58366,58367,58377,58449,58451,58452,58455,58456,
                  58457,58458,58461,58537,58542,58544,58730,58734,58735,58736,58834,58836,58839,58926,
                  58933,59034,57949,58361,58362,58370,58453,58459,58460,58462,58463,58546,58547,58548,
                  58549,58550,58557,58558,58633,58647,58737,58745,58747,58748,58917,58918,58928,58929,
                  58934,58936,58938,59037,59130,57988,57996,58464,58467,58468,58472,58553,58555,58556,
                  58565,58631,58632,58642,58643,58744,58844,58845,58846,58847,58848,58941,58942,58944,
                  58946,59038,59041,59051,59052,59131,58560,58644,58654,58746,58843,59045,59046,59047,
                  59053,59055,59081,59106,59113,59114,59134,59227,59230,57989,58559,58561,58562,58563,
                  58567,58646,58652,58657,58742,58750,59059,59061,59064,59065,59072,59074,59082,59090,
                  59122,59124,59228,59241,58477,58484,58566,58568,58749,59057,59058,59071,59094,59109,
                  59125,59126,59133,59229,59235,59242,59270,59421,58570,58658,58659,58752,58754,59075,
                  59096,59097,59099,59116,59127,59129,59246,59254,59255,59256,59264,59265,59266,59322,
                  59417,59425,59087,59088,59137,59237,59268,59269,59271,59285,59293,59303,59312,59313,
                  59320,59321,59419,58656,58660,58664,58665,58667,59107,59117,59238,59276,59280,59284,
                  59290,59304,59310,59315,59316,59426,59427,59454,58760,59279,59319,59324,59429,59431,
                  59452,59500,59501,59249,59278,59287,59289,59294,59297,59318,59435,59441,59451,59453,
                  59457,59462,59471,59473,59476,59480,59481,59485,59493,59502,59632,59981,59298,59317,
                  59446,59448,59449,59456,59487,59488,59492,59626,59631,59640,59288,59314,59469,59470,
                  59635,59644,59647,59653,59654,59659,59663,59306,59475,59477,59478,59650,59655,59656,
                  59664,59750,59940,59658,59838,59941,59945,59948,59954,59842,59843,59845,59847,59848,
                  59849,59754,59758,59851,59854,59855,59856,59951 ) and vti = 24")

